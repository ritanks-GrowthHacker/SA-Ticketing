# Test Organization Onboarding Flow

## Test 1: Create Organization with Email Verification
POST {{baseUrl}}/api/org-onboarding
Content-Type: application/json

{
  "orgName": "Tech Solutions Ltd",
  "username": "techsolutions",
  "orgEmail": "admin@techsolutions.com",
  "password": "SecurePassword123!",
  "mobileNumber": "+1234567890",
  "selectedDepartments": [
    "{{departmentId1}}",
    "{{departmentId2}}"
  ]
}

### Expected Response:
# Status: 201 Created
# {
#   "success": true,
#   "message": "Organization created successfully. Please check your email for verification code.",
#   "organizationId": "uuid-here",
#   "requiresVerification": true,
#   "orgEmail": "admin@techsolutions.com"
# }

---

## Test 2: Verify Organization Email
POST {{baseUrl}}/api/org-verify-email
Content-Type: application/json

{
  "orgEmail": "admin@techsolutions.com",
  "otp": "123456"
}

### Expected Response:
# Status: 200 OK
# {
#   "success": true,
#   "message": "Organization email verified successfully. You can now login.",
#   "verified": true
# }

---

## Test 3: Organization Login (After Verification)
POST {{baseUrl}}/api/org-login
Content-Type: application/json

{
  "username": "techsolutions",
  "password": "SecurePassword123!"
}

### Expected Response:
# Status: 200 OK
# {
#   "success": true,
#   "token": "jwt-token-here",
#   "organization": {
#     "id": "uuid-here",
#     "name": "Tech Solutions Ltd",
#     "username": "techsolutions",
#     "org_email": "admin@techsolutions.com",
#     "is_active": true,
#     "otp_verified": true,
#     "associated_departments": ["uuid1", "uuid2"]
#   }
# }

---

## Test 4: Login Before Email Verification (Should Fail)
POST {{baseUrl}}/api/org-login
Content-Type: application/json

{
  "username": "unverified_org",
  "password": "password123"
}

### Expected Response:
# Status: 401 Unauthorized
# {
#   "error": "Please verify your organization email before logging in."
# }

---

## Test 5: Invalid OTP Verification
POST {{baseUrl}}/api/org-verify-email
Content-Type: application/json

{
  "orgEmail": "admin@techsolutions.com",
  "otp": "wrong123"
}

### Expected Response:
# Status: 400 Bad Request
# {
#   "error": "Invalid OTP code"
# }

---

## Test 6: Duplicate Username Registration (Should Fail)
POST {{baseUrl}}/api/org-onboarding
Content-Type: application/json

{
  "orgName": "Another Tech Company",
  "username": "techsolutions",
  "orgEmail": "different@email.com",
  "password": "AnotherPassword123!",
  "mobileNumber": "+0987654321"
}

### Expected Response:
# Status: 409 Conflict
# {
#   "error": "Username already exists"
# }

---

## Test 7: Invalid Department IDs
POST {{baseUrl}}/api/org-onboarding
Content-Type: application/json

{
  "orgName": "Invalid Dept Company",
  "username": "invaliddept",
  "orgEmail": "invalid@company.com",
  "password": "Password123!",
  "selectedDepartments": [
    "invalid-uuid-1",
    "invalid-uuid-2"
  ]
}

### Expected Response:
# Status: 400 Bad Request
# {
#   "error": "One or more selected departments do not exist"
# }